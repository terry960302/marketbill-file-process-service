https://felixgondwe.medium.com/set-java-home-on-ubuntu-docker-container-e302a7aa45ad



## 도커 이미지별 성능 체크

### 기존
#### [ubuntu]
- 2개 -> 1.14s
- 10개 -> 5.3s
- 50개 -> 25.49s
- 100개 -> 51.7s

#### [python]
- 2개 -> 2.3s
- 10개 -> 5.6s
- 50개 -> 21.95s
- 100개 -> 43.9s

### 결론
: 큰 차이가 없음. 취향차이로 도커 이미지 선택해서 배포해도 될듯.

## 성능 개선

###  접근 방식 
#### PDF 섹션별 컴포넌트 병렬 처리
: PDF 각 컴포넌트 생성시 동기적으로 이뤄지니 컴포넌트 생성을 비동기에 병렬로 변경(asyncio.gather)
#### 요청 멀티프로세싱
: 연산 작업이 대부분이므로 멀티프로세싱으로 요청(api request) 처리
#### 메모리 집적 처리방식(buffer)
: 람다 배포시 CPU설정이 불가하니 메모리 집중형으로 전환(file write -> buffer)
  - 이미지 buffer 처리
  - PDF doc buffer 처리

### 결과
#### 컴포넌트 병렬 처리
  - 기존에 PDF처리하는 거 자체가 시간소모가 크지 않아 개선해도 별차이가 없음
#### 멀티프로세싱 요청 처리
    : 단건에선 개선이 없으나 여러 요청에서 기하급수적인 개선이 이뤄짐. 기존에 여러건 처리하는데 있어 동기적으로 요청이 처리되다보니 느렸는데 여러 프로세스에서 동시 처리가 되다보니 요청이 많아도 시간 딜레이가 적어짐
    - 1건 : 2.3s
    - 10건 : 2.66s
    - 50건 : 4.9s
    - 100건 : 8.9s
#### 메모리 집적 처리방식으로 전환(멀티프로세싱 환경)
    - 1건 처리 : 2.3s -> 0.486s 로 대략 2초 감소
    - 10건 처리 : 2.66s -> 0.949s 로 대략 1.5초 감소
    - 50건 처리 : 4.9s -> 3.5s 로 1초 감소
    - 100건 처리 : 8.9s -> 7.3s 로 1초 감소


