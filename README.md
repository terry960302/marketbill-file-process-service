# MarketBill Receipt Processing Service

## 프로젝트 소개
MarketBill Receipt Processing Service는 화훼 시장의 거래 명세서를 디지털화하는 PDF 생성 서비스입니다. Python과 FastAPI를 기반으로 구축되었으며, AWS Lambda를 통해 서버리스 아키텍처로 운영됩니다.

### 주요 기능
- PDF 형식의 거래 명세서 자동 생성
- 다중 페이지 지원 (주문 항목이 많을 경우 자동 페이지 분할)
- AWS S3를 통한 파일 저장 및 CDN 배포
- 비동기 처리를 통한 대량 요청 처리

## 기술 스택
- **Backend**: Python 3.8+, FastAPI
- **Infrastructure**: AWS Lambda, ECR, S3, CloudFront
- **Database**: PostgreSQL
- **Tools & Libraries**:
  - PyPDF2: PDF 파일 처리
  - reportlab: PDF 생성
  - boto3: AWS SDK
  - Docker: 컨테이너화

## 성능 최적화
다음과 같은 최적화 작업을 통해 성능을 대폭 개선했습니다:

### 1. 멀티프로세싱 도입
- 단일 요청 처리 시간: 2.3초
- 대량 요청 처리 성능:
  - 10건: 2.66초
  - 50건: 4.9초
  - 100건: 8.9초

### 2. 시스템 아키텍처 최적화
전체적인 시스템 아키텍처를 개선하여 처리 속도를 획기적으로 향상시켰습니다:
- 1~2건 처리: 8초 → 0.486초 (약 94% 개선)
- 10건 처리: 86초 → 0.949초 (약 99% 개선)
- 50건 처리: 389초 → 3.5초 (약 99% 개선)
- 100건 처리: 수 분 이상 → 7.3초 (대폭 개선)

## 아키텍처 개선 사항
### 1. Legacy 코드 개선
- Google Spreadsheet 기반 처리 방식에서 직접 PDF 생성 방식으로 전환
- 외부 의존성 감소 및 처리 속도 개선
- 라이센스 이슈 해결 (aspose.cells 라이센스 제한 문제 해결)

### 2. 비동기 처리 도입
- FastAPI의 비동기 처리 활용
- ProcessPoolExecutor를 통한 멀티프로세싱 구현
- 대량 요청 시 병렬 처리로 성능 향상

### 3. 컨테이너화
- 다양한 환경(dev/prod)에 대응하는 Docker 이미지 구성
- AWS ECR을 통한 컨테이너 관리
- 한글 폰트 및 로케일 설정 자동화

## 보안 및 확장성
- AWS IAM을 통한 접근 권한 관리
- CloudFront CDN을 통한 파일 배포
- 환경별(dev/prod) 설정 분리

## 프로젝트의 의의
1. **성능 최적화**: 메모리 버퍼 활용과 멀티프로세싱 도입으로 처리 속도를 최대 79% 개선했습니다.
2. **안정성 향상**: 외부 서비스 의존도를 줄이고 직접 PDF 생성 방식을 도입하여 시스템 안정성을 높였습니다.
3. **확장성**: 컨테이너화와 서버리스 아키텍처 도입으로 손쉬운 확장이 가능합니다.
